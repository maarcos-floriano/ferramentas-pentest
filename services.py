import socket
import requests

def identify_service(ip, port):
    try:
        if port == 80 or port == 443:
            protocol = 'https' if port == 443 else 'http'
            url = f"{protocol}://{ip}:{port}"
            response = requests.get(url, timeout=5)
            print(f"[{port}] HTTP/HTTPS: {response.headers['server'] if 'server' in response.headers else 'Unknown'}")
        elif port == 22:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.connect((ip, port))
            banner = sock.recv(1024).decode().strip()
            print(f"[{port}] SSH: {banner}")
            sock.close()
        else:
            print(f"[{port}] Serviço desconhecido ou não suportado.")
    except Exception as e:
        print(f"[{port}] Erro ao identificar o serviço: {e}")

target_ip = "127.0.0.1"
open_ports = [22, 80, 443]

for port in open_ports:
    identify_service(target_ip, port)
